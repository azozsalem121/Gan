## الخطوة 3 (الجزء 3): تنفيذ وتدريب نموذج WGAN-GP

في هذا الجزء، قمنا بتنفيذ وتدريب نموذج Wasserstein GAN with Gradient Penalty (WGAN-GP)، وهو تحسين على نموذج GAN الأساسي، بهدف توليد بيانات اصطناعية أكثر استقرارًا وجودة للفئة الأقلية (
'Enrolled').

### بنية النموذج:

1.  **المولد (Generator):**
    *   نفس بنية المولد المستخدمة في Vanilla GAN (طبقات Dense، Batch Normalization، ReLU، وطبقة أخيرة Sigmoid للمخرجات [0, 1]).
    *   المدخلات: متجه ضوضاء عشوائي (latent vector) بالبعد 128.
    *   المخرجات: متجه بنفس بعد بيانات الإدخال الأصلية (255).

2.  **الناقد (Critic) - بديل المميز:**
    *   بنية مشابهة للمميز في Vanilla GAN (طبقات Dense، Dropout، ReLU) ولكن **بدون دالة تنشيط Sigmoid في الطبقة الأخيرة**. المخرج هو قيمة خطية (score) بدلاً من احتمالية.
    *   المدخلات: متجه بيانات (إما حقيقي أو مولد).
    *   المخرجات: قيمة عددية (score) تمثل مدى "واقعية" البيانات المدخلة.

### إعدادات التدريب:

*   **محسنات (Optimizers):** Adam مع معدل تعلم 0.0002 و beta_1=0.5, beta_2=0.9 لكل من المولد والناقد.
*   **دوال الخسارة (Loss Functions):**
    *   **الناقد:** خسارة Wasserstein (الفرق بين متوسط score للبيانات الحقيقية ومتوسط score للبيانات المولدة) + عقوبة التدرج (Gradient Penalty).
    *   **المولد:** يحاول تعظيم متوسط score للبيانات المولدة (أي جعلها تبدو أكثر واقعية للناقد).
*   **عقوبة التدرج (Gradient Penalty):** آلية لفرض قيود Lipschitz على الناقد، مما يساعد على استقرار التدريب. تم استخدام وزن 10.0 للعقوبة.
*   **خطوات تدريب الناقد لكل خطوة مولد:** 5 (تدريب الناقد أكثر شيوع في WGAN).
*   **حجم الدفعة (Batch Size):** 64
*   **عدد الحقب (Epochs):** 1000
*   **أبعاد متجه الضوضاء (Latent Dimension):** 128

### عملية التدريب:

1.  لكل خطوة تدريب:
    *   **تدريب الناقد (لـ 5 مرات):** يتم تدريبه لتمييز الفرق بين البيانات الحقيقية والمولدة عن طريق تعظيم (score الحقيقي - score المولد) مع تطبيق عقوبة التدرج على العينات المُركبة (interpolated samples).
    *   **تدريب المولد (مرة واحدة):** يتم تدريبه لخداع الناقد عن طريق تعظيم score البيانات المولدة.
2.  تم تكرار هذه العملية لعدد 1000 من الحقب.
3.  تم حفظ نموذج المولد المدرب بشكل دوري وفي نهاية التدريب في المسار: `/Users/macbookair/Desktop/sp_project/gan_project_files/wgan_gp/wgan_gp_generator.keras`.

### النتائج:

تم إكمال التدريب بنجاح. استغرقت العملية 590.10 ثانية. نموذج المولد المدرب باستخدام WGAN-GP جاهز الآن لتوليد عينات اصطناعية جديدة لفئة 
'Enrolled'.
